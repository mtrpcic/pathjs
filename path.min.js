var Path={version:"0.8.4",map:function(a){return Path.routes.defined.hasOwnProperty(a)?Path.routes.defined[a]:new Path.core.route(a)},root:function(a){Path.routes.root=a},rescue:function(a){Path.routes.rescue=a},history:{initial:{},pushState:function(a,b,c){Path.history.supported?Path.dispatch(c)&&history.pushState(a,b,c):Path.history.fallback&&(window.location.hash="#"+c)},popState:function(a){a=!Path.history.initial.popped&&location.href==Path.history.initial.URL;Path.history.initial.popped=!0;
a||Path.dispatch(document.location.pathname)},listen:function(a){Path.history.supported=!(!window.history||!window.history.pushState);Path.history.fallback=a;if(Path.history.supported)Path.history.initial.popped="state"in window.history,Path.history.initial.URL=location.href,window.onpopstate=Path.history.popState;else if(Path.history.fallback){for(route in Path.routes.defined)"#"!=route.charAt(0)&&(Path.routes.defined["#"+route]=Path.routes.defined[route],Path.routes.defined["#"+route].path="#"+
route);Path.listen()}}},match:function(a,b){var c={},d=null,l,f,e,h,k,g;for(d in Path.routes.defined)if(null!==d&&void 0!==d)for(d=Path.routes.defined[d],l=d.partition(),h=0;h<l.length;h++){f=l[h];k=a;if(0<f.search(/:/))for(e=0;e<f.split("/").length;e++)g=k.split("/"),e<g.length&&":"===f.split("/")[e].charAt(0)&&(c[f.split("/")[e].replace(/:/,"")]=g[e],g[e]=f.split("/")[e],k=g.join("/"));if(f===k)return b&&(d.params=c),d}return null},dispatch:function(a){var b;if(Path.routes.current!==a){Path.routes.previous=
Path.routes.current;Path.routes.current=a;b=Path.match(a,!0);Path.routes.previous&&(a=Path.match(Path.routes.previous),null!==a&&null!==a.do_exit&&a.do_exit());if(null!==b)return b.run(),!0;null!==Path.routes.rescue&&Path.routes.rescue()}},listen:function(){var a=function(){Path.dispatch(location.hash)};""===location.hash&&null!==Path.routes.root&&(location.hash=Path.routes.root);"onhashchange"in window&&(!document.documentMode||8<=document.documentMode)?window.onhashchange=a:setInterval(a,50);""!==
location.hash&&Path.dispatch(location.hash)},core:{route:function(a){this.path=a;this.action=null;this.do_enter=[];this.do_exit=null;this.params={};Path.routes.defined[a]=this}},routes:{current:null,root:null,rescue:null,previous:null,defined:{}}};
Path.core.route.prototype={to:function(a){this.action=a;return this},enter:function(a){a instanceof Array?this.do_enter=this.do_enter.concat(a):this.do_enter.push(a);return this},exit:function(a){this.do_exit=a;return this},partition:function(){for(var a=[],b=[],c=/\(([^}]+?)\)/g,d;d=c.exec(this.path);)a.push(d[1]);b.push(this.path.split("(")[0]);for(c=0;c<a.length;c++)b.push(b[b.length-1]+a[c]);return b},run:function(){var a=!1,b,c;if(Path.routes.defined[this.path].hasOwnProperty("do_enter")&&0<
Path.routes.defined[this.path].do_enter.length)for(b=0;b<Path.routes.defined[this.path].do_enter.length;b++)if(c=Path.routes.defined[this.path].do_enter[b].apply(this,null),!1===c){a=!0;break}a||Path.routes.defined[this.path].action()}};
